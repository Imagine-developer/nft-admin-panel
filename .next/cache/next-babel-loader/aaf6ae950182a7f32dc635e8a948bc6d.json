{"ast":null,"code":"var _jsxFileName = \"/Users/andreyplatonov/Downloads/Telegram Desktop/wieldy-v-2.4.3/next-js-jwt-stater-kit/util/use-auth.js\";\nvar __jsx = React.createElement;\nimport React, { useState, useEffect, useContext, createContext } from \"react\";\nimport { httpClient } from \"./Api\";\nimport { Cookies } from \"react-cookie\";\nconst authContext = /*#__PURE__*/createContext(); // Provider component that wraps app and makes auth object ..\n// ... available to any child component that calls useAuth().\n\nexport function AuthProvider({\n  children\n}) {\n  const auth = useProvideAuth();\n  return __jsx(authContext.Provider, {\n    value: auth,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 12,\n      columnNumber: 10\n    }\n  }, children);\n} // Hook for child components to get the auth object ...\n// ... and re-render when it changes.\n\nexport const useAuth = () => {\n  return useContext(authContext);\n};\n\nconst useProvideAuth = () => {\n  const {\n    0: authUser,\n    1: setAuthUser\n  } = useState(null);\n  const {\n    0: loadingAuthUser,\n    1: setLoadingAuthUser\n  } = useState(true);\n  const {\n    0: isLoading,\n    1: setLoading\n  } = useState(false);\n  const {\n    0: error,\n    1: setError\n  } = useState('');\n\n  const fetchStart = () => {\n    setLoading(true);\n    setError('');\n  };\n\n  const fetchSuccess = () => {\n    setLoading(false);\n    setError('');\n  };\n\n  const fetchError = error => {\n    setLoading(false);\n    setError(error);\n  };\n\n  const userLogin = (data, callbackFun) => {\n    fetchStart();\n    httpClient.post('admin/login', data).then(({\n      data\n    }) => {\n      if (data.result) {\n        fetchSuccess();\n        httpClient.defaults.headers.common['Authorization'] = 'Bearer ' + data.token.access_token;\n        const cookies = new Cookies();\n        cookies.set('token', data.token.access_token);\n        getAuthUser();\n        if (callbackFun) callbackFun();\n      } else {\n        fetchError(data.error);\n      }\n    }).catch(function (error) {\n      fetchError(error.message);\n    });\n  };\n\n  const userSignup = (data, callbackFun) => {\n    fetchStart();\n    httpClient.post('auth/register', data).then(({\n      data\n    }) => {\n      if (data.result) {\n        fetchSuccess();\n        httpClient.defaults.headers.common['Authorization'] = 'Bearer ' + data.token.access_token;\n        const cookies = new Cookies();\n        cookies.set('token', data.token.access_token);\n        if (callbackFun) callbackFun();\n      } else {\n        fetchError(data.error);\n      }\n    }).catch(function (error) {\n      fetchError(error.message);\n    });\n  };\n\n  const userSignOut = callbackFun => {\n    fetchStart();\n\n    if (data.result) {\n      fetchSuccess();\n      setAuthUser(false);\n      httpClient.defaults.headers.common['Authorization'] = '';\n      const cookies = new Cookies();\n      cookies.remove('token');\n    } else {\n      fetchError(data.error);\n    }\n\n    ß;\n  };\n\n  const getAuthUser = () => {\n    fetchStart();\n    httpClient.post(\"auth/me\").then(({\n      data\n    }) => {\n      if (data.user) {\n        fetchSuccess();\n        setAuthUser(data.user);\n      } else {\n        fetchError(data.error);\n      }\n    }).catch(function (error) {\n      httpClient.defaults.headers.common['Authorization'] = '';\n      fetchError(error.message);\n    });\n  }; // Subscribe to user on mount\n  // Because this sets state in the callback it will cause any ...\n  // ... component that utilizes this hook to re-render with the ...\n  // ... latest auth object.\n\n\n  useEffect(() => {\n    const cookies = new Cookies();\n    const token = cookies.get(\"token\");\n    httpClient.defaults.headers.common['Authorization'] = 'Bearer ' + token;\n    httpClient.post(\"auth/me\").then(({\n      data\n    }) => {\n      if (data.user) {\n        setAuthUser(data.user);\n      }\n\n      setLoadingAuthUser(false);\n    }).catch(function (error) {\n      cookies.remove('token');\n      httpClient.defaults.headers.common['Authorization'] = '';\n      setLoadingAuthUser(false);\n    });\n  }, []); // Return the user object and auth methods\n\n  return {\n    loadingAuthUser,\n    isLoading,\n    authUser,\n    error,\n    setAuthUser,\n    getAuthUser,\n    userLogin,\n    userSignup,\n    userSignOut\n  };\n};\n\nexport const isUnRestrictedRoute = pathname => {\n  return pathname === '/signin' || pathname === '/signup' || pathname === '/forgot-password' || pathname === '/reset-password';\n};","map":{"version":3,"sources":["/Users/andreyplatonov/Downloads/Telegram Desktop/wieldy-v-2.4.3/next-js-jwt-stater-kit/util/use-auth.js"],"names":["React","useState","useEffect","useContext","createContext","httpClient","Cookies","authContext","AuthProvider","children","auth","useProvideAuth","useAuth","authUser","setAuthUser","loadingAuthUser","setLoadingAuthUser","isLoading","setLoading","error","setError","fetchStart","fetchSuccess","fetchError","userLogin","data","callbackFun","post","then","result","defaults","headers","common","token","access_token","cookies","set","getAuthUser","catch","message","userSignup","userSignOut","remove","ß","user","get","isUnRestrictedRoute","pathname"],"mappings":"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","sourcesContent":["import React, {useState, useEffect, useContext, createContext} from \"react\";\r\nimport {httpClient} from \"./Api\";\r\nimport {Cookies} from \"react-cookie\";\r\n\r\nconst authContext = createContext();\r\n\r\n// Provider component that wraps app and makes auth object ..\r\n// ... available to any child component that calls useAuth().\r\n\r\nexport function AuthProvider({children}) {\r\n  const auth = useProvideAuth();\r\n  return <authContext.Provider value={auth}>{children}</authContext.Provider>;\r\n}\r\n\r\n// Hook for child components to get the auth object ...\r\n// ... and re-render when it changes.\r\n\r\nexport const useAuth = () => {\r\n  return useContext(authContext);\r\n};\r\n\r\nconst useProvideAuth = () => {\r\n  const [authUser, setAuthUser] = useState(null);\r\n  const [loadingAuthUser, setLoadingAuthUser] = useState(true);\r\n  const [isLoading, setLoading] = useState(false);\r\n  const [error, setError] = useState('');\r\n\r\n  const fetchStart = () => {\r\n    setLoading(true);\r\n    setError('');\r\n  }\r\n\r\n  const fetchSuccess = () => {\r\n    setLoading(false);\r\n    setError('');\r\n  }\r\n\r\n  const fetchError = (error) => {\r\n    setLoading(false);\r\n    setError(error);\r\n  }\r\n\r\n  const userLogin = (data, callbackFun) => {\r\n    fetchStart();\r\n    httpClient.post('admin/login', data)\r\n      .then(({data}) => {\r\n        if (data.result) {\r\n          fetchSuccess();\r\n          httpClient.defaults.headers.common['Authorization'] = 'Bearer ' + data.token.access_token;\r\n          const cookies = new Cookies();\r\n          cookies.set('token', data.token.access_token);\r\n          getAuthUser();\r\n          if (callbackFun) callbackFun();\r\n        } else {\r\n          fetchError(data.error);\r\n        }\r\n      })\r\n      .catch(function (error) {\r\n        fetchError(error.message);\r\n      });\r\n  };\r\n\r\n  const userSignup = (data, callbackFun) => {\r\n    fetchStart();\r\n    httpClient.post('auth/register', data)\r\n      .then(({data}) => {\r\n        if (data.result) {\r\n          fetchSuccess();\r\n          httpClient.defaults.headers.common['Authorization'] = 'Bearer ' + data.token.access_token;\r\n          const cookies = new Cookies();\r\n          cookies.set('token', data.token.access_token);\r\n          if (callbackFun) callbackFun();\r\n        } else {\r\n          fetchError(data.error);\r\n        }\r\n      })\r\n      .catch(function (error) {\r\n        fetchError(error.message);\r\n      });\r\n  };\r\n\r\n  const userSignOut = (callbackFun) => {\r\n    fetchStart();\r\n        if (data.result) {\r\n          fetchSuccess();\r\n          setAuthUser(false);\r\n          httpClient.defaults.headers.common['Authorization'] = '';\r\n          const cookies = new Cookies();\r\n          cookies.remove('token');\r\n        } else {\r\n          fetchError(data.error);\r\n        }ß\r\n  };\r\n\r\n  const getAuthUser = () => {\r\n    fetchStart();\r\n    httpClient.post(\"auth/me\").then(({data}) => {\r\n      if (data.user) {\r\n        fetchSuccess();\r\n        setAuthUser(data.user);\r\n      } else {\r\n        fetchError(data.error);\r\n      }\r\n    }).catch(function (error) {\r\n      httpClient.defaults.headers.common['Authorization'] = '';\r\n      fetchError(error.message);\r\n    });\r\n  }\r\n\r\n  // Subscribe to user on mount\r\n  // Because this sets state in the callback it will cause any ...\r\n  // ... component that utilizes this hook to re-render with the ...\r\n  // ... latest auth object.\r\n\r\n  useEffect(() => {\r\n      const cookies = new Cookies();\r\n      const token = cookies.get(\"token\");\r\n      httpClient.defaults.headers.common['Authorization'] = 'Bearer ' + token;\r\n\r\n      httpClient.post(\"auth/me\").then(({data}) => {\r\n        if (data.user) {\r\n          setAuthUser(data.user);\r\n        }\r\n        setLoadingAuthUser(false);\r\n      }).catch(function (error) {\r\n        cookies.remove('token');\r\n        httpClient.defaults.headers.common['Authorization'] = '';\r\n        setLoadingAuthUser(false);\r\n      });\r\n    }, []\r\n  );\r\n\r\n  // Return the user object and auth methods\r\n  return {\r\n    loadingAuthUser,\r\n    isLoading,\r\n    authUser,\r\n    error,\r\n    setAuthUser,\r\n    getAuthUser,\r\n    userLogin,\r\n    userSignup,\r\n    userSignOut,\r\n  };\r\n}\r\n\r\nexport const isUnRestrictedRoute = (pathname) => {\r\n  return pathname === '/signin' || pathname === '/signup' || pathname === '/forgot-password' || pathname === '/reset-password';\r\n}\r\n"]},"metadata":{},"sourceType":"module"}